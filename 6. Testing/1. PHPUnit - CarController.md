https://lernen.zbw.ch/mod/page/view.php?id=73080

---
OPTIONAL (Erstellt eine zweite Datenbank, das Produktive bei Test nicht verändert wird.)
*(*
*Im Projektordner (gleicher ort wo die ".env" Datei ist) eine neue ".env.testing" Datei erstellen.*
*Von ".env.example" und dann diesen Code hinzufügen:*
```php
DB_CONNECTION=sqlite 
DB_DATABASE=:memory:
```
*)*

---
Command ausführen um Test zu erstellen:
```bash
ddev php artisan make:test CarControllerTest --unit
```

In "CarControllerTest.php" diesen Code einfügen:
```php
<?php

namespace Tests\Feature;

use App\Models\Car;
use App\Models\User;
use Illuminate\Foundation\Testing\RefreshDatabase;
use Tests\TestCase;

class CarControllerTest extends TestCase
{
    use RefreshDatabase;

    /** @test */
    public function index_zeigt_alle_autos()
    {
        $this->actingAs(User::factory()->create());

        $cars = Car::factory()->count(3)->create();

        $response = $this->get('/cars');

        $response->assertStatus(200);
        $response->assertViewIs('cars.index');
        $response->assertViewHas('cars', function ($viewCars) use ($cars) {
            return $viewCars->count() === $cars->count();
        });
    }

    /** @test */
    public function store_erstellt_neues_auto()
    {
        $this->actingAs(User::factory()->create());

        $payload = [
            'name' => 'Testauto',
            'price' => 10000,
            'kraftstoff' => 'Benzin',
            'farbe' => 'Rot',
            'bauart' => 'SUV',
            'tank' => 60,
            'jahrgang' => '2021-01-01',
        ];

        $response = $this->post('/cars', $payload);

        $response->assertRedirect('/cars');
        $this->assertDatabaseHas('cars', ['name' => 'Testauto']);
    }

    /** @test */
    public function update_aendert_auto_details()
    {
        $this->actingAs(User::factory()->create());

        $car = Car::factory()->create(['name' => 'Altes Auto']);

        $payload = [
            'name' => 'Aktualisiertes Auto',
            'price' => 15000,
            'kraftstoff' => 'Diesel',
            'farbe' => 'Blau',
            'bauart' => 'Coupe',
            'tank' => 55,
            'jahrgang' => '2022-01-01',
        ];

        $response = $this->put("/cars/{$car->id}", $payload);

        $response->assertRedirect('/cars');
        $this->assertDatabaseHas('cars', ['name' => 'Aktualisiertes Auto']);
    }

    /** @test */
    public function destroy_entfernt_auto()
    {
        $this->actingAs(User::factory()->create());

        $car = Car::factory()->create();

        $response = $this->delete("/cars/{$car->id}");

        $response->assertRedirect('/cars');
        $this->assertDatabaseMissing('cars', ['id' => $car->id]);
    }
}
```

Tests durchführen
```bash
ddev php artisan test
```
